sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/Label","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/Fragment"],function(e,t,o,r,i,a){"use strict";return e.extend("sierra.pra.PRA_Custom.controller.payout_position",{onInit:function(){var e=this;debugger;this.globalModel=this.getOwnerComponent().getModel("globalModel");debugger;var o=new t(this.globalModel);console.log("omodel first ",o);debugger;o.setSizeLimit(500);this.getView().setModel(o,"oModel");console.log("oModel l",o);debugger;this.getOwnerComponent().getModel().read("/Revenue_HDRSet",{success:function(t,r){debugger;e.globalModel.header=[];debugger;e.globalModel.companyList=t.results;for(var i=0;i<e.globalModel.companyList.length;i++){e.globalModel.header.push(e.globalModel.companyList[i])}debugger;e.getView().getModel("oModel").refresh();debugger;debugger;debugger;e.aKeys=["CmpCode","Doi","DeckType"];e.oSelectName=e.getSelect("slName");e.oSelectCategory=e.getSelect("slCategory");e.oSelectSupplierName=e.getSelect("slDOIType");o.setProperty("/Filter/text","Filtered by None");e.addSnappedLabel();var a=e.getView().byId("filterbar");if(a){a.variantsInitialized()}},error:function(e){debugger}})},onSelectRequestRevenueHeaderList:function(e){var t=this.getView().getModel("oModel");var o=e.getSource()._aSelectedPaths;this.globalModel.navigatedRequest=t.getProperty(o[0]);var r=e.getSource()._aSelectedPaths;var i=r[0];var a=i.slice(i.length-1);this.selectedProgramIndex=parseInt(a)},onPopinLayoutChanged:function(){var e=this.byId("idProductsTable");var t=this.byId("idPopinLayout");var o=t.getSelectedKey();switch(o){case"Block":e.setPopinLayout(PopinLayout.Block);break;case"GridLarge":e.setPopinLayout(PopinLayout.GridLarge);break;case"GridSmall":e.setPopinLayout(PopinLayout.GridSmall);break;default:e.setPopinLayout(PopinLayout.Block);break}},onDisplayForm:function(e){var t=this.getView().getModel("oModel");this.globalModel.navigationMode="Display";var o=sap.ui.core.UIComponent.getRouterFor(this);o.navTo("owner_details",{},true)},onDoiHeaderAddPress:function(){var e=this.getView();var t=this;if(!t.pErrorLogPopover){t.pErrorLogPopover=a.load({id:e.getId(),name:"sierra.pra.PRA_Custom.view.doi_header_add",controller:t}).then(function(t){debugger;e.addDependent(t);return t})}t.pErrorLogPopover.then(function(e){e.open()})},onCloseErrorLogPopover:function(){this.byId("ErrorLogPopover").destroy();this.pErrorLogPopover=undefined;debugger},onExit:function(){this.aKeys=[];this.aFilters=[];this.oModel=null},onToggleHeader:function(){this.getPage().setHeaderExpanded(!this.getPage().getHeaderExpanded())},onToggleFooter:function(){this.getPage().setShowFooter(!this.getPage().getShowFooter())},onSelectChange:function(){var e=[];e.push(this.getSelectedItemText(this.oSelectName));e.push(this.getSelectedItemText(this.oSelectCategory));e.push(this.getSelectedItemText(this.oSelectSupplierName));this.filterTable(e)},filterTable:function(e){this.getTableItems().filter(this.getFilters(e));this.updateFilterCriterias(this.getFilterCriteria(e))},updateFilterCriterias:function(e){this.removeSnappedLabel();this.addSnappedLabel();debugger;this.oModel.setProperty("/Filter/text",this.getFormattedSummaryText(e));debugger},addSnappedLabel:function(){var e=this.getSnappedLabel();e.attachBrowserEvent("click",this.onToggleHeader,this);this.getPageTitle().addSnappedContent(e)},removeSnappedLabel:function(){this.getPageTitle().destroySnappedContent()},getFilters:function(e){this.aFilters=[];this.aFilters=this.aKeys.map(function(t,o){return new r(t,i.Contains,e[o])});return this.aFilters},getFilterCriteria:function(e){return this.aKeys.filter(function(t,o){if(e[o]!==""){return t}})},getFormattedSummaryText:function(e){if(e.length>0){return"Filtered By ("+e.length+"): "+e.join(", ")}else{return"Filtered by None"}},getTable:function(){return this.getView().byId("idProductsTable")},getTableItems:function(){return this.getTable().getBinding("items")},getSelect:function(e){return this.getView().byId(e)},getSelectedItemText:function(e){return e.getSelectedItem()?e.getSelectedItem().getKey():""},getPage:function(){return this.getView().byId("dynamicPageId")},getPageTitle:function(){return this.getPage().getTitle()},getSnappedLabel:function(){return new o({text:"{/Filter/text}"})}})});